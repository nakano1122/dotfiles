# スラッシュコマンドテンプレート

## 目次

- [worker スラッシュコマンドテンプレート](#worker-スラッシュコマンドテンプレート)
- [fix スラッシュコマンドテンプレート](#fix-スラッシュコマンドテンプレート)
- [品質チェックリスト](#品質チェックリスト)

## worker スラッシュコマンドテンプレート

`.claude/commands/worker-{タスク名}.md` として生成する。
**非対話で自律実行されるため、曖昧さを排除し具体的に記述すること。**

````markdown
# 実装指示

質問せず、以下の指示に従って自律的に実装を完了してください。

## 環境情報

- 作業ディレクトリ: .worktrees/task-{作業名}/
- ブランチ: task/{作業名}
- 親ブランチ: feature/{機能名}

## 環境セットアップ確認

実装開始前に、作業ディレクトリで以下を確認・実行すること:

```bash
cd .worktrees/task-{作業名}

# 作業ディレクトリが worktree 内であることを確認
pwd  # 必ず .worktrees/task-{作業名} であること

# .claude/ ディレクトリの確認（なければメインリポからコピー）
if [ ! -d ".claude" ] && [ -d "../../.claude" ]; then
    cp -r "../../.claude" ".claude"
fi

# 依存関係の確認（なければインストール）
ls node_modules > /dev/null 2>&1 || pnpm install
```

**重要: すべてのファイル操作はこの worktree ディレクトリ内で行うこと。メインリポジトリ（プロジェクトルート）のファイルを編集してはならない。**

## タスク概要

{タスクの概要と目的}

## 使用スキル

/{スキル名}

## 仕様

{具体的な仕様。箇条書きで明確に}

## 参照すべき既存コード

以下のファイルを参照して、同じパターンで実装すること:

- {ファイルパス1}: {参照理由}
- {ファイルパス2}: {参照理由}

## プロジェクト規約

- ディレクトリ構成: {パターン}
- 命名規則: {ルール}
- import エイリアス: {設定}

## 実装ステップ

### Step 1: {概要}

- ファイル: {パス}
- 内容: {具体的な実装内容}

### Step 2: {概要}

- ファイル: {パス}
- 内容: {具体的な実装内容}

{必要なだけ Step を追加}

## テスト要件

- テストファイル: {パス}
- テストケース:
  - {ケース1}
  - {ケース2}

## コミット方針

作業中はこまめにコミットすること:

- 意味のある変更単位（ファイル 1 つ、機能 1 つ等）ごとにコミット
- テストが通る状態になったらコミット
- 長時間の作業では 15〜30 分ごとに中間コミット
- 最終的に品質ゲート通過後にも最終コミットを行う

## 品質ゲート

すべてのコマンドがパスするまでコミットしないこと:

```bash
{lint コマンド}
{test コマンド}
{format コマンド}
{type-check コマンド}
```

## 完了手順

1. すべての品質ゲートをパスさせる
2. 変更をコミット・プッシュする:

```bash
cd .worktrees/task-{作業名}
git add {対象ファイル}
git commit -m "{type}: {概要}"
git push -u origin task/{作業名}
```

3. 以下のフォーマットで完了を出力:

```
=== 実装完了 ===

{変更内容サマリー}

【次のアクション】
1. 以下の情報で PR を作成してください:
   - ベースブランチ: feature/{機能名}
   - ヘッドブランチ: task/{作業名}
2. PR 作成後、オーケストレーターにレビューを依頼してください
```

## エラー対応

- 品質ゲートのエラーは自力で修正する
- 解決不能なエラーが発生した場合:
  1. 現時点の変更をコミット・プッシュする
  2. コミットメッセージにエラー情報を含める（例: `wip: {概要} - {エラー内容}`）
  3. 完了出力にエラーの詳細を記載する
````

## fix スラッシュコマンドテンプレート

レビュー後の修正指示として `.claude/commands/fix-{タスク名}.md` を生成する。
**毎回上書き方式**で、常に最新の修正指示のみを保持する。

````markdown
# 修正指示

質問せず、以下の指示に従って自律的に修正を完了してください。

## 環境情報

- 作業ディレクトリ: .worktrees/task-{作業名}/
- ブランチ: task/{作業名}

## 修正項目

### 1. [{重要度: 必須/推奨}] {ファイルパス}

- 現状の問題: {問題の説明}
- 修正内容: {具体的な修正内容}

### 2. [{重要度: 必須/推奨}] {ファイルパス}

- 現状の問題: {問題の説明}
- 修正内容: {具体的な修正内容}

{必要なだけ項目を追加}

## 修正範囲の限定

以下はスコープ外。変更しないこと:

- {スコープ外の項目1}
- {スコープ外の項目2}

## コミット方針

修正項目ごとにこまめにコミットすること。

## 品質ゲート

すべてのコマンドがパスするまでコミットしないこと:

```bash
{lint コマンド}
{test コマンド}
{format コマンド}
```

## 完了手順

1. すべての品質ゲートをパスさせる
2. 変更をコミット・プッシュする:

```bash
cd .worktrees/task-{作業名}
git add {対象ファイル}
git commit -m "fix: レビュー指摘対応"
git push
```

3. 以下のフォーマットで完了を出力:

```
=== 修正完了 ===

{修正内容サマリー}

【次のアクション】
1. オーケストレーターに再レビューを依頼してください
```
````

## 品質チェックリスト

生成したスラッシュコマンドを以下で自己検証する:

- [ ] 作業ディレクトリ・ブランチが正しく指定されているか
- [ ] 環境セットアップ確認ステップが含まれているか
- [ ] 使用スキルが明記されているか
- [ ] 仕様が具体的で曖昧さがないか
- [ ] 参照すべき既存コードのパスが正しいか
- [ ] 作成/変更ファイル一覧が網羅されているか
- [ ] 実装ステップが順序立てて記述されているか
- [ ] テスト要件が明確か
- [ ] 品質ゲートコマンドが正しいか
- [ ] コミット・プッシュ手順が含まれているか
- [ ] 「質問せず自律実行」が明記されているか
- [ ] エラー対応手順が含まれているか
- [ ] メインリポジトリ編集禁止が明記されているか
- [ ] こまめなコミットの方針が明記されているか
